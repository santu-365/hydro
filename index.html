<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HydroBottles | Future Fluidity</title>
    <meta name="description" content="Next-gen hydration hardware.">
    
    <!-- Google Fonts: Outfit -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@200;400;600;800&display=swap" rel="stylesheet">
    
    <style>
        /* 
        ========================================
        CORE VARIABLES & RESET
        ========================================
        */
        :root {
            --bg-dark: #050505;
            --bg-panel: rgba(255, 255, 255, 0.03);
            --bg-panel-hover: rgba(255, 255, 255, 0.08);
            
            --primary: #00f2ea;
            --primary-dim: #008f8a;
            --secondary: #ff0055;
            
            --text-main: #ffffff;
            --text-muted: #888888;
            
            --glass-border: 1px solid rgba(255, 255, 255, 0.1);
            --glass-blur: blur(20px);
            
            --ease-out: cubic-bezier(0.23, 1, 0.32, 1);
            --font-main: 'Outfit', sans-serif;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        html { scroll-behavior: smooth; }
        
        body {
            background-color: var(--bg-dark);
            color: var(--text-main);
            font-family: var(--font-family);
            overflow-x: hidden;
            font-family: var(--font-main);
            cursor: none; /* Custom cursor */
        }

        /* 
        ========================================
        UTILITIES & ANIMATIONS
        ========================================
        */
        .noise-overlay {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none;
            z-index: 9000;
            opacity: 0.05;
            background: url('https://grainy-gradients.vercel.app/noise.svg');
        }

        .container {
            width: 90%;
            max-width: 1400px;
            margin: 0 auto;
        }

        section {
            padding: 8rem 0;
            position: relative;
            z-index: 2;
        }

        h1, h2, h3, h4 { font-weight: 800; text-transform: uppercase; letter-spacing: -0.02em; }
        
        .section-header { margin-bottom: 5rem; text-align: center; }
        .section-title { font-size: 4rem; line-height: 1; margin-bottom: 1rem; background: linear-gradient(to right, #fff, #888); -webkit-background-clip: text; -webkit-text-fill-color: transparent;}
        .section-subtitle { color: var(--primary); font-family: monospace; letter-spacing: 0.2em; }

        /* Scramble Text Effect Class */
        .scramble-text { display: inline-block; }

        /* 
        ========================================
        CUSTOM CURSOR
        ========================================
        */
        .cursor-dot, .cursor-circle {
            position: fixed;
            top: 0; left: 0;
            transform: translate(-50%, -50%);
            border-radius: 50%;
            z-index: 9999;
            pointer-events: none;
        }
        .cursor-dot { width: 8px; height: 8px; background: var(--primary); }
        .cursor-circle {
            width: 40px; height: 40px;
            border: 1px solid rgba(255,255,255,0.3);
            transition: width 0.3s, height 0.3s, background 0.3s;
        }
        body.hovering .cursor-circle {
            width: 80px; height: 80px;
            background: rgba(255, 255, 255, 0.1);
            border-color: var(--primary);
            backdrop-filter: blur(2px);
        }

        /* 
        ========================================
        HEADER & NAV
        ========================================
        */
        header {
            position: fixed;
            top: 0; width: 100%;
            z-index: 1000;
            padding: 1.5rem 0;
            transition: 0.3s;
            border-bottom: var(--glass-border);
            background: rgba(5, 5, 5, 0.6);
            backdrop-filter: var(--glass-blur);
        }

        .nav-flex { display: flex; justify-content: space-between; align-items: center; }
        
        .logo { font-size: 1.5rem; font-weight: 800; color: white; text-decoration: none; display: flex; align-items: center; gap: 10px; }
        .logo span { color: var(--primary); }
        
        .nav-links { display: flex; gap: 3rem; list-style: none; }
        .nav-links a {
            color: var(--text-muted);
            text-decoration: none;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            transition: 0.3s;
        }
        .nav-links a:hover { color: var(--text-main); text-shadow: 0 0 10px var(--primary); }

        .header-icons { display: flex; gap: 1.5rem; align-items: center; }
        .icon-btn { background: none; border: none; color: white; cursor: pointer; position: relative; }
        .cart-count {
            position: absolute; top: -8px; right: -8px;
            background: var(--secondary); color: white;
            font-size: 10px; width: 16px; height: 16px;
            border-radius: 50%; display: flex; align-items: center; justify-content: center;
        }

        /* 
        ========================================
        HERO SECTION
        ========================================
        */
        .hero {
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        #bg-canvas {
            position: absolute;
            top: 0; left: 0;
            width: 100%; height: 100%;
            z-index: 0;
        }

        .hero-content { position: relative; z-index: 2; max-width: 900px; }
        
        .hero-title {
            font-size: 6rem; /* Fallback */
            font-size: clamp(4rem, 10vw, 8rem);
            line-height: 0.9;
            margin-bottom: 2rem;
            background: linear-gradient(135deg, #fff 0%, #888 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .hero-btn {
            display: inline-block;
            padding: 1rem 3rem;
            background: transparent;
            border: 1px solid var(--primary);
            color: var(--primary);
            text-transform: uppercase;
            font-weight: 700;
            text-decoration: none;
            letter-spacing: 0.2em;
            position: relative;
            overflow: hidden;
            transition: 0.3s;
            margin-top: 2rem;
        }

        .hero-btn::before {
            content: ''; position: absolute;
            top: 0; left: -100%; width: 100%; height: 100%;
            background: var(--primary);
            transition: 0.4s var(--ease-out);
            z-index: -1;
        }

        .hero-btn:hover { color: #000; box-shadow: 0 0 30px var(--primary-dim); }
        .hero-btn:hover::before { left: 0; }

        /* 
        ========================================
        MARQUEE
        ========================================
        */
        .marquee {
            background: var(--primary);
            color: #000;
            padding: 1rem 0;
            overflow: hidden;
            white-space: nowrap;
            transform: rotate(-2deg) scale(1.05);
            border-top: 2px solid #fff;
            border-bottom: 2px solid #fff;
            margin: 0;
        }
        
        .marquee-content {
            display: inline-block;
            animation: marquee 20s linear infinite;
            font-weight: 900;
            font-size: 1.5rem;
            text-transform: uppercase;
        }
        
        @keyframes marquee { 0% { transform: translateX(0); } 100% { transform: translateX(-50%); } }

        /* 
        ========================================
        GLASS PRODUCT GRID (TILT EFFECT)
        ========================================
        */
        .product-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
        }

        .card {
            background: var(--bg-panel);
            border: var(--glass-border);
            border-radius: 20px;
            padding: 2rem;
            position: relative;
            transition: transform 0.1s;
            transform-style: preserve-3d;
            perspective: 1000px;
        }
        
        .card-content {
            transform: translateZ(20px); /* 3D pop */
            display: flex; flex-direction: column; height: 100%;
        }

        .card-image-wrap {
            height: 300px;
            display: flex; align-items: center; justify-content: center;
            margin-bottom: 1.5rem;
            position: relative;
        }

        .card-img {
            max-height: 100%;
            filter: drop-shadow(0 20px 30px rgba(0,0,0,0.5));
            transition: 0.3s;
        }

        .card:hover .card-img { transform: scale(1.1) rotate(5deg); }

        .card-title { font-size: 1.5rem; margin-bottom: 0.5rem; }
        .card-price { color: var(--primary); font-size: 1.25rem; font-weight: 600; margin-bottom: 1rem; }
        .card-desc { color: var(--text-muted); font-size: 0.9rem; margin-bottom: auto; line-height: 1.6; }

        .add-btn {
            width: 100%;
            padding: 1rem;
            margin-top: 1.5rem;
            background: rgba(255,255,255,0.1);
            border: none;
            color: white;
            font-family: var(--font-main);
            text-transform: uppercase;
            font-weight: 700;
            cursor: pointer;
            transition: 0.3s;
            border-radius: 8px;
        }
        .add-btn:hover { background: var(--primary); color: #000; }

        /* Glare effect on tilt */
        .card::after {
            content: "";
            position: absolute; inset: 0;
            background: linear-gradient(125deg, rgba(255,255,255,0.1) 0%, transparent 40%, transparent 60%, rgba(255,255,255,0.1) 100%);
            border-radius: 20px;
            opacity: 0; transition: opacity 0.3s;
            pointer-events: none;
        }
        .card:hover::after { opacity: 1; }

        /* 
        ========================================
        CUSTOMIZER (Split Layout)
        ========================================
        */
        .customizer-layout {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 4rem;
            align-items: center;
        }

        .preview-stage {
            height: 600px;
            background: radial-gradient(circle at center, rgba(0,242,234,0.1) 0%, transparent 70%);
            display: flex; align-items: center; justify-content: center;
            border: var(--glass-border);
            border-radius: 30px;
            position: relative;
        }

        .preview-img { height: 80%; z-index: 2; transition: 0.5s; }
        .engraving-text {
            position: absolute;
            bottom: 25%;
            font-family: monospace;
            color: rgba(255,255,255,0.7);
            font-size: 1.2rem;
            text-shadow: 0 1px 2px rgba(0,0,0,0.5);
            transform: rotate(-2deg);
            z-index: 3;
        }

        .controls-panel {
            background: var(--bg-panel);
            padding: 3rem;
            border-radius: 20px;
            border: var(--glass-border);
            backdrop-filter: var(--glass-blur);
        }

        .control-group { margin-bottom: 2rem; }
        .control-label { display: block; margin-bottom: 1rem; color: var(--text-muted); text-transform: uppercase; font-size: 0.8rem; letter-spacing: 1px; }

        .color-grid { display: flex; gap: 10px; }
        .color-btn {
            width: 40px; height: 40px;
            border-radius: 50%;
            border: 2px solid transparent;
            cursor: pointer;
            transition: 0.3s;
        }
        .color-btn.active { border-color: white; transform: scale(1.2); }

        .text-input {
            width: 100%;
            background: rgba(0,0,0,0.3);
            border: 1px solid #333;
            padding: 1rem;
            color: white;
            font-family: var(--font-main);
            border-radius: 8px;
        }
        .text-input:focus { outline: none; border-color: var(--primary); }

        /* 
        ========================================
        CART DRAWER
        ========================================
        */
        .cart-overlay {
            position: fixed; inset: 0;
            background: rgba(0,0,0,0.8);
            backdrop-filter: blur(5px);
            z-index: 1001;
            opacity: 0; pointer-events: none;
            transition: 0.3s;
        }
        .cart-overlay.open { opacity: 1; pointer-events: all; }

        .cart-drawer {
            position: fixed; top: 0; right: -450px;
            width: 450px; height: 100%;
            background: #0a0a0a;
            border-left: var(--glass-border);
            z-index: 1002;
            padding: 2rem;
            display: flex; flex-direction: column;
            transition: 0.4s var(--ease-out);
        }
        .cart-drawer.open { right: 0; }

        .cart-items { flex-grow: 1; overflow-y: auto; margin: 2rem 0; list-style: none; }
        .cart-item {
            display: flex; align-items: center; gap: 1rem;
            padding: 1rem;
            background: rgba(255,255,255,0.05);
            margin-bottom: 1rem;
            border-radius: 8px;
        }
        .cart-item img { width: 50px; height: 50px; object-fit: contain; }
        .cart-total { font-size: 1.5rem; border-top: 1px solid #333; padding-top: 1rem; display: flex; justify-content: space-between; }

        /* 
        ========================================
        FOOTER
        ========================================
        */
        footer {
            border-top: var(--glass-border);
            padding: 4rem 0;
            background: #020202;
            text-align: center;
            color: var(--text-muted);
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            .section-title { font-size: 2.5rem; }
            .customizer-layout { grid-template-columns: 1fr; }
            .nav-links { display: none; } /* Simplified for demo */
            .cart-drawer { width: 100%; right: -100%; }
        }
    </style>
</head>
<body>

    <!-- Noise Texture Overlay -->
    <div class="noise-overlay"></div>

    <!-- Custom Cursor -->
    <div class="cursor-dot"></div>
    <div class="cursor-circle"></div>

    <!-- Navigation -->
    <header>
        <div class="container nav-flex">
            <a href="#" class="logo" data-hover>
                <svg width="24" height="24" viewBox="0 0 24 24" fill="var(--primary)"><path d="M12,2c-5,0-9,4-9,9c0,5,4,9,9,9s9-4,9-9C21,6,17,2,12,2z M12,18c-3.9,0-7-3.1-7-7c0-3.9,3.1-7,7-7s7,3.1,7,7C19,14.9,15.9,18,12,18z"/><circle cx="12" cy="11" r="2.5"/></svg>
                HYDRO<span>BOTTLES</span>
            </a>
            <ul class="nav-links">
                <li><a href="#products" data-hover>Collection</a></li>
                <li><a href="#customizer" data-hover>Lab</a></li>
                <li><a href="#tech" data-hover>Technology</a></li>
            </ul>
            <div class="header-icons">
                <button class="icon-btn" id="cart-btn" data-hover>
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"></path><line x1="3" y1="6" x2="21" y2="6"></line><path d="M16 10a4 4 0 0 1-8 0"></path></svg>
                    <span class="cart-count">0</span>
                </button>
            </div>
        </div>
    </header>

    <!-- Cart Drawer -->
    <div class="cart-overlay"></div>
    <div class="cart-drawer">
        <div style="display:flex; justify-content:space-between; align-items:center;">
            <h2>Your Cart</h2>
            <button class="icon-btn" id="close-cart">âœ•</button>
        </div>
        <ul class="cart-items" id="cart-items-list">
            <!-- Items injected via JS -->
            <li style="text-align:center; color:#555; margin-top:2rem;">Your hydration pod is empty.</li>
        </ul>
        <div class="cart-footer">
            <div class="cart-total">
                <span>Total</span>
                <span id="cart-total-price">$0.00</span>
            </div>
            <button class="hero-btn" style="width:100%; margin-top:1rem;">Checkout</button>
        </div>
    </div>

    <!-- Hero Section -->
    <section class="hero">
        <canvas id="bg-canvas"></canvas>
        <div class="hero-content">
            <div class="section-subtitle">PROJECT HYDRATION</div>
            <h1 class="hero-title" id="scramble-hero">FUTURE FLUIDITY</h1>
            <p style="font-size: 1.2rem; color: var(--text-muted); max-width: 600px; margin: 0 auto 2rem;">
                Engineered with aerospace-grade composites and smart-sensor integration. 
                Drink water like it's 2077.
            </p>
            <a href="#products" class="hero-btn" data-hover>Initialize Shop</a>
        </div>
    </section>

    <!-- Infinite Marquee -->
    <div class="marquee">
        <div class="marquee-content">
            SMART SENSORS /// 24H COLD INSULATION /// TITANIUM ALLOY CORE /// BLUETOOTH SYNC /// RGB LIGHTING /// SMART SENSORS /// 24H COLD INSULATION /// TITANIUM ALLOY CORE /// BLUETOOTH SYNC /// RGB LIGHTING ///
        </div>
    </div>

    <!-- Products Section -->
    <section id="products">
        <div class="container">
            <div class="section-header">
                <div class="section-subtitle">THE COLLECTION</div>
                <h2 class="section-title scramble-text">Hardware</h2>
            </div>
            
            <div class="product-grid">
                <!-- Product 1 -->
                <div class="card" data-tilt data-id="1" data-price="45" data-title="Cyber Flask V1">
                    <div class="card-image-wrap">
                        <img src="https://placehold.co/300x400/00f2ea/000000.png?text=CYBER+V1" alt="Bottle" class="card-img">
                    </div>
                    <div class="card-content">
                        <h3 class="card-title">Cyber Flask V1</h3>
                        <div class="card-price">$45.00</div>
                        <p class="card-desc">Standard issue hydration unit. Matte finish with neon accents.</p>
                        <button class="add-btn" data-hover>Add to Cart</button>
                    </div>
                </div>

                <!-- Product 2 -->
                <div class="card" data-tilt data-id="2" data-price="89" data-title="Smart Core Pro">
                    <div class="card-image-wrap">
                        <img src="https://placehold.co/300x400/ff0055/ffffff.png?text=CORE+PRO" alt="Bottle" class="card-img">
                    </div>
                    <div class="card-content">
                        <h3 class="card-title">Smart Core Pro</h3>
                        <div class="card-price">$89.00</div>
                        <p class="card-desc">Integrated OLED display. Tracks intake and temperature.</p>
                        <button class="add-btn" data-hover>Add to Cart</button>
                    </div>
                </div>

                <!-- Product 3 -->
                <div class="card" data-tilt data-id="3" data-price="65" data-title="Stealth Ops">
                    <div class="card-image-wrap">
                        <img src="https://placehold.co/300x400/333333/ffffff.png?text=STEALTH" alt="Bottle" class="card-img">
                    </div>
                    <div class="card-content">
                        <h3 class="card-title">Stealth Ops</h3>
                        <div class="card-price">$65.00</div>
                        <p class="card-desc">Radar absorbent material. 48oz capacity. Heavy duty.</p>
                        <button class="add-btn" data-hover>Add to Cart</button>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Customizer Section -->
    <section id="customizer" style="background: radial-gradient(circle at top right, #111, #000);">
        <div class="container">
            <div class="section-header">
                <div class="section-subtitle">THE LAB</div>
                <h2 class="section-title scramble-text">Customize</h2>
            </div>

            <div class="customizer-layout">
                <div class="preview-stage">
                    <div class="engraving-text" id="engraving-preview"></div>
                    <img id="custom-bottle-img" src="https://placehold.co/300x500/00f2ea/000000.png?text=V1" class="preview-img">
                </div>
                
                <div class="controls-panel">
                    <h3 style="margin-bottom: 2rem;">Configuration</h3>
                    
                    <div class="control-group">
                        <span class="control-label">Nano-Coating Color</span>
                        <div class="color-grid">
                            <button class="color-btn active" style="background:#00f2ea" data-color="00f2ea" data-hover></button>
                            <button class="color-btn" style="background:#ff0055" data-color="ff0055" data-hover></button>
                            <button class="color-btn" style="background:#ffffff" data-color="ffffff" data-hover></button>
                            <button class="color-btn" style="background:#ffff00" data-color="ffff00" data-hover></button>
                        </div>
                    </div>

                    <div class="control-group">
                        <span class="control-label">Laser Engraving</span>
                        <input type="text" class="text-input" id="engraving-input" placeholder="ENTER TEXT..." maxlength="12" data-hover>
                    </div>

                    <div style="display:flex; justify-content:space-between; align-items:center; margin-top:3rem;">
                        <div style="font-size:2rem; font-weight:700;">$55.00</div>
                        <button class="hero-btn" id="add-custom-btn" data-hover>Build Unit</button>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer>
        <div class="container">
            <h3>HydroBottles Co.</h3>
            <p style="margin: 1rem 0;">Designed in 2025. Built for the future.</p>
            <div style="display:flex; justify-content:center; gap:1rem; margin-top:2rem;">
                <a href="#" style="color:white;">Instagram</a>
                <a href="#" style="color:white;">Twitter</a>
            </div>
        </div>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            
            // --- 1. Custom Cursor Logic ---
            const cursorDot = document.querySelector('.cursor-dot');
            const cursorCircle = document.querySelector('.cursor-circle');
            
            document.addEventListener('mousemove', (e) => {
                cursorDot.style.left = e.clientX + 'px';
                cursorDot.style.top = e.clientY + 'px';
                
                // Slight delay for the circle
                setTimeout(() => {
                    cursorCircle.style.left = e.clientX + 'px';
                    cursorCircle.style.top = e.clientY + 'px';
                }, 50);
            });

            // Hover state for interactive elements
            document.querySelectorAll('[data-hover]').forEach(el => {
                el.addEventListener('mouseenter', () => document.body.classList.add('hovering'));
                el.addEventListener('mouseleave', () => document.body.classList.remove('hovering'));
            });

            // --- 2. 3D Tilt Effect for Cards ---
            const cards = document.querySelectorAll('[data-tilt]');
            
            cards.forEach(card => {
                card.addEventListener('mousemove', (e) => {
                    const rect = card.getBoundingClientRect();
                    const x = e.clientX - rect.left;
                    const y = e.clientY - rect.top;
                    
                    const centerX = rect.width / 2;
                    const centerY = rect.height / 2;
                    
                    const rotateX = ((y - centerY) / centerY) * -10; // Max rotation deg
                    const rotateY = ((x - centerX) / centerX) * 10;
                    
                    card.style.transform = `perspective(1000px) rotateX(${rotateX}deg) rotateY(${rotateY}deg) scale3d(1.02, 1.02, 1.02)`;
                });
                
                card.addEventListener('mouseleave', () => {
                    card.style.transform = `perspective(1000px) rotateX(0) rotateY(0) scale3d(1, 1, 1)`;
                });
            });

            // --- 3. Scramble Text Effect ---
            const letters = "ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";
            
            const scrambleElements = document.querySelectorAll('.scramble-text, #scramble-hero');
            
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        scramble(entry.target);
                    }
                });
            }, { threshold: 0.5 });

            scrambleElements.forEach(el => observer.observe(el));

            function scramble(element) {
                let iterations = 0;
                const originalText = element.innerText;
                
                const interval = setInterval(() => {
                    element.innerText = originalText.split("")
                        .map((letter, index) => {
                            if(index < iterations) {
                                return originalText[index];
                            }
                            return letters[Math.floor(Math.random() * 26)];
                        })
                        .join("");
                    
                    if(iterations >= originalText.length) clearInterval(interval);
                    iterations += 1/3;
                }, 30);
            }

            // --- 4. Interactive Particle Background (Canvas) ---
            const canvas = document.getElementById('bg-canvas');
            const ctx = canvas.getContext('2d');
            let width, height;
            let particles = [];
            
            function resize() {
                width = canvas.width = window.innerWidth;
                height = canvas.height = window.innerHeight;
            }
            window.addEventListener('resize', resize);
            resize();

            class Particle {
                constructor() {
                    this.x = Math.random() * width;
                    this.y = Math.random() * height;
                    this.vx = (Math.random() - 0.5) * 0.5;
                    this.vy = (Math.random() - 0.5) * 0.5;
                    this.size = Math.random() * 2;
                }
                update() {
                    this.x += this.vx;
                    this.y += this.vy;
                    if(this.x < 0) this.x = width;
                    if(this.x > width) this.x = 0;
                    if(this.y < 0) this.y = height;
                    if(this.y > height) this.y = 0;
                }
                draw() {
                    ctx.fillStyle = 'rgba(0, 242, 234, 0.3)';
                    ctx.beginPath();
                    ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                    ctx.fill();
                }
            }

            for(let i=0; i<100; i++) particles.push(new Particle());

            function animateCanvas() {
                ctx.clearRect(0, 0, width, height);
                particles.forEach(p => {
                    p.update();
                    p.draw();
                });
                // Connect particles
                particles.forEach((a, index) => {
                    particles.slice(index + 1).forEach(b => {
                        const dx = a.x - b.x;
                        const dy = a.y - b.y;
                        const dist = Math.sqrt(dx*dx + dy*dy);
                        if(dist < 100) {
                            ctx.strokeStyle = `rgba(0, 242, 234, ${0.1 - dist/1000})`;
                            ctx.beginPath();
                            ctx.moveTo(a.x, a.y);
                            ctx.lineTo(b.x, b.y);
                            ctx.stroke();
                        }
                    });
                });
                requestAnimationFrame(animateCanvas);
            }
            animateCanvas();

            // --- 5. Cart Logic ---
            let cart = [];
            const cartBtn = document.getElementById('cart-btn');
            const closeCartBtn = document.getElementById('close-cart');
            const cartDrawer = document.querySelector('.cart-drawer');
            const cartOverlay = document.querySelector('.cart-overlay');
            const cartCountEl = document.querySelector('.cart-count');
            const cartItemsList = document.getElementById('cart-items-list');
            const cartTotalEl = document.getElementById('cart-total-price');

            function toggleCart() {
                cartDrawer.classList.toggle('open');
                cartOverlay.classList.toggle('open');
            }

            cartBtn.addEventListener('click', toggleCart);
            closeCartBtn.addEventListener('click', toggleCart);
            cartOverlay.addEventListener('click', toggleCart);

            window.addToCart = function(item) {
                cart.push(item);
                updateCartUI();
                toggleCart();
            }

            function updateCartUI() {
                cartCountEl.innerText = cart.length;
                cartItemsList.innerHTML = '';
                let total = 0;

                cart.forEach((item, index) => {
                    total += item.price;
                    const li = document.createElement('li');
                    li.className = 'cart-item';
                    li.innerHTML = `
                        <img src="${item.img}" alt="img">
                        <div style="flex-grow:1">
                            <div style="font-weight:700">${item.title}</div>
                            <div style="font-size:0.8rem; color:#888;">${item.meta || ''}</div>
                        </div>
                        <div style="color:var(--primary); font-weight:700;">$${item.price}</div>
                    `;
                    cartItemsList.appendChild(li);
                });

                cartTotalEl.innerText = '$' + total.toFixed(2);
            }

            document.querySelectorAll('.add-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const card = e.target.closest('.card');
                    const item = {
                        title: card.dataset.title,
                        price: parseFloat(card.dataset.price),
                        img: card.querySelector('img').src
                    };
                    window.addToCart(item);
                });
            });

            // --- 6. Customizer Logic ---
            const colorBtns = document.querySelectorAll('.color-btn');
            const bottleImg = document.getElementById('custom-bottle-img');
            const engravingInput = document.getElementById('engraving-input');
            const engravingPreview = document.getElementById('engraving-preview');
            const addCustomBtn = document.getElementById('add-custom-btn');
            let selectedColor = '00f2ea'; // Default cyan

            colorBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    // Visual active state
                    colorBtns.forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    
                    // Change Image color (using Placeholder API for demo)
                    selectedColor = btn.dataset.color;
                    bottleImg.src = `https://placehold.co/300x500/${selectedColor}/000000.png?text=CUSTOM`;
                    
                    // Simple animation reset
                    bottleImg.style.opacity = 0;
                    setTimeout(() => bottleImg.style.opacity = 1, 100);
                });
            });

            engravingInput.addEventListener('input', (e) => {
                engravingPreview.innerText = e.target.value;
            });

            addCustomBtn.addEventListener('click', () => {
                window.addToCart({
                    title: 'Custom Build',
                    price: 55.00,
                    img: bottleImg.src,
                    meta: `Color: #${selectedColor} | Text: ${engravingInput.value}`
                });
            });

        });
    </script>
</body>
</html>
